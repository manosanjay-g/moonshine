<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Letter</title>
    <link rel="stylesheet" href="css/flower.css" />
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script>
      (function () {
        emailjs.init("tXU3Pw1VvZeWMk8LY");
      })();
    </script>

    <style>
      .letter {
        max-width: 600px;
        margin: 0px auto;
        padding: 30px;
        background: rgba(255, 255, 255, 0.85);
        border-radius: 12px;
        font-family: Georgia, serif;
        line-height: 1.8;
        color: #333;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .letter p {
        margin-bottom: 16px;
      }
    </style>
  </head>

  <body>
    <div id="thankyou"><b>Thank you for being my girlfriend</b></div>
    <div id="letter" class="letter"></div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const getJSON = (key, fallback = []) => {
          try {
            return JSON.parse(localStorage.getItem(key)) ?? fallback;
          } catch {
            return fallback;
          }
        };

        const date =
          localStorage.getItem("selectedDate") || "a day we‚Äôll remember";
        const food = getJSON("selectedFood");
        const desserts = getJSON("selectedDesserts");
        const activities = getJSON("selectedActivities");

        const letterHTML = `
          <p>Hey Shrenidhi ‚ù§Ô∏è,</p>

          <p>
            I wanted to write this down instead of saying it out loud,
            because some things deserve to be remembered properly.
          </p>

          <p>Here‚Äôs what I have in mind for us:</p>

          <p>
            <b>üìÖ The day:</b><br />
            ${date}
          </p>

          <p>
            <b>üçΩÔ∏è What we‚Äôll eat:</b><br />
            ${food.length ? food.join(", ") : "Whatever we feel like that day"}
          </p>

          <p>
            <b>üç∞ Something sweet:</b><br />
            ${
              desserts.length
                ? desserts.join(", ")
                : "Definitely something sweet"
            }
          </p>

          <p>
            <b>üéâ What we‚Äôll do:</b><br />
            ${activities.length ? activities.join(", ") : "Just being together"}
          </p>

          <p>
            No rush. No pressure.<br />
            Just us, taking our time.
          </p>

          <p>
            Can‚Äôt wait ü§ç,<br />
            Manny
          </p>
        `;

        document.getElementById("letter").innerHTML = letterHTML;

        emailjs.send("service_nxeyr7c", "template_fin3eof", {
          to_email: "shrenidhic@gmail.com",
          date: date,
          food: food.length ? food.join(", ") : "Whatever we feel like",
          desserts: desserts.length ? desserts.join(", ") : "Something sweet",
          activities: activities.length
            ? activities.join(", ")
            : "Just being together",
          name: "Shrenidhi",
          from_name: "Manny",
        });
      });
    </script>
  </body>
</html>
